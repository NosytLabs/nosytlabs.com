---
/**
 * Service Detail Component
 * 
 * Comprehensive service detail page with features, pricing, testimonials, and CTAs
 */

import type { ServiceData } from '../../config/services/types';
import AstroIcon from '../ui/AstroIcon.astro';
import Button from '../ui/Button.astro';
import EnhancedServiceCard from './EnhancedServiceCard.astro';
import { allServices } from '../../config/services';

interface Props {
  service: ServiceData;
}

const { service } = Astro.props;

// Get related services (same category, excluding current service)
const relatedServices = allServices
  .filter(s => s.category === service.category && s.id !== service.id)
  .slice(0, 2);
---

<article class="py-20">
  <div class="container mx-auto px-4">
    <!-- Hero Section -->
    <div class="max-w-4xl mx-auto text-center mb-16">
      <!-- Breadcrumb -->
      <nav class="flex justify-center items-center space-x-2 text-sm text-gray-500 mb-6">
        <a href="/" class="hover:text-primary transition-colors">Home</a>
        <AstroIcon name="chevronRight" class="w-4 h-4" />
        <a href="/services" class="hover:text-primary transition-colors">Services</a>
        <AstroIcon name="chevronRight" class="w-4 h-4" />
        <span class="text-gray-900 dark:text-white">{service.name}</span>
      </nav>

      <!-- Service Icon and Category -->
      <div class="flex items-center justify-center space-x-4 mb-6">
        <div class="p-4 rounded-2xl bg-gradient-to-br from-primary to-secondary text-white">
          <AstroIcon name={service.icon} class="w-8 h-8" />
        </div>
        <div>
          <span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-primary/10 text-primary mb-2">
            {service.category}
          </span>
          {service.popular && (
            <span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-yellow-400 to-orange-500 text-white ml-2">
              <AstroIcon name="star" class="w-3 h-3 mr-1 inline" />
              Popular
            </span>
          )}
        </div>
      </div>

      <!-- Title and Description -->
      <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-6">
        {service.name}
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-300 leading-relaxed mb-8">
        {service.description}
      </p>

      <!-- Pricing and Timeline -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-8 mb-8">
        <div class="text-center">
          <div class="text-3xl font-bold text-primary mb-1">{service.price}</div>
          <div class="text-sm text-gray-500">Investment</div>
        </div>
        <div class="hidden sm:block w-px h-12 bg-gray-300"></div>
        <div class="text-center">
          <div class="text-3xl font-bold text-secondary mb-1">{service.timeline}</div>
          <div class="text-sm text-gray-500">Timeline</div>
        </div>
      </div>

      <!-- Primary CTA -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button
          href="/contact"
          variant="primary"
          size="lg"
          class="px-8 py-4 text-lg"
        >
          {service.cta}
          <AstroIcon name="arrowRight" class="w-5 h-5 ml-2" />
        </Button>
        <Button
          href="/projects"
          variant="outline"
          size="lg"
          class="px-8 py-4 text-lg"
        >
          View Examples
        </Button>
      </div>
    </div>

    <!-- Key Features Overview -->
    <div class="max-w-6xl mx-auto mb-20">
      <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">
        What's Included
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {service.features.map((feature, index) => (
          <div class="flex items-start space-x-3 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300">
            <div class="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center text-white text-sm font-bold">
              {index + 1}
            </div>
            <div>
              <h3 class="font-semibold text-gray-900 dark:text-white mb-1">{feature}</h3>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Detailed Features -->
    {service.detailedFeatures && (
      <div class="max-w-6xl mx-auto mb-20">
        <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">
          Detailed Features & Benefits
        </h2>
        <div class="space-y-12">
          {service.detailedFeatures.map((section, index) => (
            <div class={`flex flex-col ${index % 2 === 0 ? 'lg:flex-row' : 'lg:flex-row-reverse'} items-center gap-12`}>
              <div class="flex-1">
                <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                  {section.title}
                </h3>
                <p class="text-gray-600 dark:text-gray-300 mb-6 text-lg leading-relaxed">
                  {section.description}
                </p>
                <ul class="space-y-3">
                  {section.items.map((item) => (
                    <li class="flex items-start space-x-3">
                      <AstroIcon name="check" class="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" />
                      <span class="text-gray-700 dark:text-gray-300">{item}</span>
                    </li>
                  ))}
                </ul>
              </div>
              <div class="flex-1">
                <div class="bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl p-8 h-80 flex items-center justify-center">
                  <div class="text-center">
                    <AstroIcon name={service.icon} class="w-24 h-24 text-primary mx-auto mb-4" />
                    <h4 class="text-xl font-semibold text-gray-900 dark:text-white">
                      {section.title}
                    </h4>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    )}

    <!-- Testimonial -->
    {service.testimonial && (
      <div class="max-w-4xl mx-auto mb-20">
        <div class="bg-gradient-to-r from-primary to-secondary rounded-2xl p-12 text-white text-center">
          <AstroIcon name="quote" class="w-12 h-12 mx-auto mb-6 opacity-80" />
          <blockquote class="text-2xl font-medium mb-6 leading-relaxed">
            "{service.testimonial.quote}"
          </blockquote>
          <cite class="text-lg opacity-90">
            â€” {service.testimonial.author}, {service.testimonial.company}
          </cite>
        </div>
      </div>
    )}

    <!-- Process Section -->
    <div class="max-w-6xl mx-auto mb-20">
      <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">
        Our Process
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        {[
          { step: '1', title: 'Discovery', desc: 'We analyze your requirements and goals' },
          { step: '2', title: 'Planning', desc: 'We create a detailed project roadmap' },
          { step: '3', title: 'Development', desc: 'We build your solution with precision' },
          { step: '4', title: 'Launch', desc: 'We deploy and provide ongoing support' }
        ].map((phase) => (
          <div class="text-center group">
            <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white font-bold text-xl group-hover:scale-110 transition-transform duration-300">
              {phase.step}
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">{phase.title}</h3>
            <p class="text-gray-600 dark:text-gray-300 text-sm">{phase.desc}</p>
          </div>
        ))}
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="max-w-4xl mx-auto mb-20">
      <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">
        Frequently Asked Questions
      </h2>
      <div class="space-y-6">
        {[
          {
            q: `What makes your ${service.name.toLowerCase()} different?`,
            a: `Our approach combines cutting-edge technology with proven methodologies to deliver solutions that not only meet your current needs but scale with your business growth.`
          },
          {
            q: 'How long does the project take?',
            a: `Typically ${service.timeline.toLowerCase()}, but we'll provide a detailed timeline during our initial consultation based on your specific requirements.`
          },
          {
            q: 'Do you provide ongoing support?',
            a: 'Yes, we offer comprehensive support packages including maintenance, updates, and technical assistance to ensure your solution continues to perform optimally.'
          },
          {
            q: 'Can you work with our existing systems?',
            a: 'Absolutely. We specialize in creating solutions that integrate seamlessly with your current infrastructure and workflows.'
          }
        ].map((faq, index) => (
          <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
            <button 
              class="w-full text-left flex items-center justify-between faq-toggle"
              data-target={`faq-${index}`}
            >
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white pr-4">
                {faq.q}
              </h3>
              <AstroIcon name="chevronDown" class="w-5 h-5 text-gray-500 transition-transform duration-300" />
            </button>
            <div class="faq-content hidden mt-4 pt-4 border-t border-gray-200 dark:border-gray-700" id={`faq-${index}`}>
              <p class="text-gray-600 dark:text-gray-300 leading-relaxed">{faq.a}</p>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Related Services -->
    {relatedServices.length > 0 && (
      <div class="max-w-6xl mx-auto mb-20">
        <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">
          Related Services
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          {relatedServices.map((relatedService) => (
            <EnhancedServiceCard service={relatedService} showDetails={false} />
          ))}
        </div>
      </div>
    )}

    <!-- Final CTA -->
    <div class="max-w-4xl mx-auto text-center bg-gradient-to-r from-primary to-secondary rounded-2xl p-12 text-white">
      <h2 class="text-3xl font-bold mb-4">
        Ready to Get Started?
      </h2>
      <p class="text-xl mb-8 opacity-90">
        Let's discuss how we can help you achieve your goals with {service.name.toLowerCase()}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button
          href="/contact"
          variant="secondary"
          size="lg"
          class="bg-white text-primary hover:bg-gray-100 px-8 py-4 text-lg"
        >
          Start Your Project
          <AstroIcon name="arrowRight" class="w-5 h-5 ml-2" />
        </Button>
        <Button
          href="/services"
          variant="outline"
          size="lg"
          class="border-white text-white hover:bg-white hover:text-primary px-8 py-4 text-lg"
        >
          View All Services
        </Button>
      </div>
    </div>
  </div>
</article>

<script>
  // FAQ toggle functionality
  document.addEventListener('DOMContentLoaded', function() {
    const faqToggles = document.querySelectorAll('.faq-toggle');
    
    faqToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const content = document.getElementById(targetId);
        const icon = this.querySelector('svg');
        
        if (content.classList.contains('hidden')) {
          content.classList.remove('hidden');
          icon.style.transform = 'rotate(180deg)';
        } else {
          content.classList.add('hidden');
          icon.style.transform = 'rotate(0deg)';
        }
      });
    });
  });
</script>