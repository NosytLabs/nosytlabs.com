---
import MainLayout from '../layouts/MainLayout.astro';
---

<MainLayout 
  title="Performance Dashboard | NosytLabs" 
  description="Real-time performance monitoring dashboard showing Core Web Vitals, resource budgets, and custom metrics"
  pageKey="performance-dashboard"
>
  <div id="performance-dashboard-root"></div>
  
  <script>
    import('/src/components/performance/PerformanceDashboard.tsx').then(({ default: PerformanceDashboard }) => {
      import('react').then(React => {
        import('react-dom/client').then(ReactDOM => {
          const root = ReactDOM.createRoot(document.getElementById('performance-dashboard-root'));
          root.render(React.createElement(PerformanceDashboard));
        });
      });
    }).catch(error => {
      console.error('Failed to load Performance Dashboard:', error);
      document.getElementById('performance-dashboard-root').innerHTML = `
        <div class="min-h-screen bg-gray-50 flex items-center justify-center">
          <div class="text-center">
            <div class="text-red-600 mb-4">
              <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-semibold text-gray-900 mb-2">Dashboard Unavailable</h2>
            <p class="text-gray-600 mb-4">The performance dashboard could not be loaded.</p>
            <button onclick="window.location.reload()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
              Retry
            </button>
          </div>
        </div>
      `;
    });
  </script>
  
  <style>
    /* Ensure the dashboard takes full height */
    #performance-dashboard-root {
      min-height: calc(100vh - 200px);
    }
    
    /* Loading state styles */
    .dashboard-loading {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 400px;
    }
    
    .dashboard-loading .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</MainLayout>