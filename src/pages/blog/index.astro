---
import MainLayout from '../../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import Section from '../../components/layout/Section.astro';
import Container from '../../components/layout/Container.astro';
import PageHero from '../../components/layout/PageHero.astro';
import BlogSearch from '../../components/blog/BlogSearch';
import { createImagePath, SITE_CONFIG } from '../../lib/constants';
import type { BlogPost } from '../../types/blog';

const posts = (await getCollection('blog')).sort(
  (a: BlogPost, b: BlogPost) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const blogJsonLd = {
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Nosyt Labs Blog",
  "description": "Thoughts, tutorials, and insights on web development, AI, and design. Stay updated with the latest trends in LLMs, coding tools, and modern web technologies.",
  "url": `${SITE_CONFIG.BASE_URL}/blog`,
  "blogPost": posts.slice(0, 5).map((post: BlogPost) => ({
    "@type": "BlogPosting",
    "headline": post.data.title,
    "description": post.data.description,
    "url": `${SITE_CONFIG.BASE_URL}/blog/${post.slug}`,
    "datePublished": post.data.pubDate.toISOString(),
    "dateModified": post.data.updatedDate?.toISOString() || post.data.pubDate.toISOString(),
    "author": {
      "@type": "Organization",
      "name": "Nosyt Labs"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Nosyt Labs",
      "logo": {
        "@type": "ImageObject",
        "url": `${SITE_CONFIG.BASE_URL}/images/logo-icon.webp`
      }
    }
  }))
};
---

<MainLayout 
  title="Web Development & AI Integration Blog - Expert Insights | NOSYT Labs" 
  description="Expert insights on web development, AI integration, modern frameworks, and digital innovation. Learn from our tutorials, case studies, and industry analysis to stay ahead in tech."
  keywords={["web development blog", "AI integration tutorials", "React tutorials", "Node.js guides", "modern web development", "tech insights", "programming tutorials", "digital innovation"]}
  ogTitle="NOSYT Labs Blog - Web Development & AI Integration Insights"
  ogDescription="Stay updated with expert tutorials, case studies, and insights on web development, AI integration, and modern technologies from the NOSYT Labs team."
  ogImage={createImagePath('images/blog-index-og.jpg')}
>
  <script type="application/ld+json" is:inline set:html={JSON.stringify(blogJsonLd)} />
  
  <!-- Hero Section -->
  <PageHero 
    title="Our Blog"
    subtitle="Thoughts, tutorials, and insights on web development, AI, and design. Stay updated with the latest trends in LLMs, coding tools, and modern web technologies."
    size="standard"
    background="gradient"
  />

  <!-- Blog Search and Posts Section -->
  <Section background="default" spacing="lg">
    <Container size="standard">
      <BlogSearch posts={posts} client:load />
    </Container>
  </Section>
</MainLayout>

